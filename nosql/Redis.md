**Redis是一对键值数据库**

# 1.安装Redis

![image-20221101161705729](typora图片/image-20221101161705729.png)

![image-20221101161801802](typora图片/image-20221101161801802.png)

# 2.Redis的基本操作

![image-20221101162014688](typora图片/image-20221101162014688.png)

![image-20221101162252439](typora图片/image-20221101162252439.png)

![image-20221101162310243](typora图片/image-20221101162310243.png)

# 3.数据类型介绍

## 3.1String类型

![image-20221101163455282](typora图片/image-20221101163455282.png)

<img src="typora图片/image-20221101163545438.png" alt="image-20221101163545438" style="zoom:67%;" />

![image-20221101163613564](typora图片/image-20221101163613564.png)

![image-20221101164634178](typora图片/image-20221101164634178.png)

![image-20221101165318901](typora图片/image-20221101165318901.png)

![image-20221101171256182](typora图片/image-20221101171256182.png)

![image-20221101171356362](typora图片/image-20221101171356362.png)

![image-20221101171526384](typora图片/image-20221101171526384.png)

![image-20221211151353562](typora图片/image-20221211151353562.png)

![image-20221211151708200](typora图片/image-20221211151708200.png)

![image-20221211151744332](typora图片/image-20221211151744332.png)

## 3.2Hash类型

![image-20221211151923849](typora图片/image-20221211151923849.png)

![image-20221211152035854](typora图片/image-20221211152035854.png)

![image-20221211152351233](typora图片/image-20221211152351233.png)

![image-20221211152547700](typora图片/image-20221211152547700.png)

![image-20221211152826754](typora图片/image-20221211152826754.png)

![image-20221211153229749](typora图片/image-20221211153229749.png)

![image-20221211153652824](typora图片/image-20221211153652824.png)

![image-20221211154216403](typora图片/image-20221211154216403.png)

![image-20221211154510961](typora图片/image-20221211154510961.png)

<img src="typora图片/image-20221211154524963.png" alt="image-20221211154524963" style="zoom:50%;" />

![image-20221211154752585](typora图片/image-20221211154752585.png)

![image-20221211154938035](typora图片/image-20221211154938035.png)

![image-20221211155100619](typora图片/image-20221211155100619.png)

![image-20221211155150748](typora图片/image-20221211155150748.png)

## 3.3List类型

![image-20221211155550724](typora图片/image-20221211155550724.png)

![image-20221211160450818](typora图片/image-20221211160450818.png)

![image-20221211161247593](typora图片/image-20221211161247593.png)

<img src="typora图片/image-20221211161606567.png" alt="image-20221211161606567" style="zoom:33%;" />

![image-20221211161855619](typora图片/image-20221211161855619.png)

![image-20221211162253263](typora图片/image-20221211162253263.png)

<img src="typora图片/image-20221211163110909.png" alt="image-20221211163110909" style="zoom:33%;" />

## 3.4Set类型

![image-20221211163305853](typora图片/image-20221211163305853.png)

![image-20221211163825686](typora图片/image-20221211163825686.png)

![image-20221211163918912](typora图片/image-20221211163918912.png)

![image-20221211164105078](typora图片/image-20221211164105078.png)

![image-20221211164333134](typora图片/image-20221211164333134.png)

![image-20221211164355899](typora图片/image-20221211164355899.png)

![image-20221211164832306](typora图片/image-20221211164832306.png)

![image-20221211164912034](typora图片/image-20221211164912034.png)

![image-20221211165002117](typora图片/image-20221211165002117.png)

![image-20221211165028829](typora图片/image-20221211165028829.png)

![image-20221211165140248](typora图片/image-20221211165140248.png)

![image-20221211165515306](typora图片/image-20221211165515306.png)

<img src="typora图片/image-20221211165637501.png" alt="image-20221211165637501" style="zoom:33%;" />

![image-20221211165813387](typora图片/image-20221211165813387.png)

![image-20221211170001021](typora图片/image-20221211170001021.png)

![image-20221211170227363](typora图片/image-20221211170227363.png)

![image-20221211170343677](typora图片/image-20221211170343677.png)

## 3.5sorted_set类型

   ![image-20221212124701039](typora图片/image-20221212124701039.png)

![image-20221212125247806](typora图片/image-20221212125247806.png)

![image-20221212125651419](typora图片/image-20221212125651419.png)

![image-20221212125858250](typora图片/image-20221212125858250.png)

![image-20221212130325872](typora图片/image-20221212130325872.png)

![image-20221212130623438](typora图片/image-20221212130623438.png)

![image-20221212131007852](typora图片/image-20221212131007852.png)

<img src="typora图片/image-20221212131018878.png" alt="image-20221212131018878" style="zoom:50%;" />

![image-20221212131048087](typora图片/image-20221212131048087.png)

![image-20221212131219216](typora图片/image-20221212131219216.png)

![image-20221212132353788](typora图片/image-20221212132353788.png)

![image-20221212132819494](typora图片/image-20221212132819494.png)

![image-20221212145727178](typora图片/image-20221212145727178.png)

![image-20221212150811111](typora图片/image-20221212150811111.png)

![image-20221212150301044](typora图片/image-20221212150301044.png)

![image-20221212150729056](typora图片/image-20221212150729056.png)

![image-20221212150747818](typora图片/image-20221212150747818.png)

# 4.通用命令

## 1.key通用命令

### 1.key的基本操作

<img src="typora图片/image-20221212155017533.png" alt="image-20221212155017533" style="zoom:50%;" />

### 2.key时效性控制

![image-20221212155516950](typora图片/image-20221212155516950.png)

### 3.key的查询模式

![image-20221212155752523](typora图片/image-20221212155752523.png)

### 4.key的其他操作

![image-20221212160447684](typora图片/image-20221212160447684.png)

## 2.数据库通用命令

### 1.db的基本操作

![image-20221212160619238](typora图片/image-20221212160619238.png)

![image-20221212160812358](typora图片/image-20221212160812358.png)

### 2.db的其他操作

![image-20221212160918941](typora图片/image-20221212160918941.png)

![image-20221212161142534](typora图片/image-20221212161142534.png)

# 5.jedis

## 1.jedis简介

![image-20221212162329461](typora图片/image-20221212162329461.png)

## 2.java连接

导入坐标

```xml
<dependency>
           <groupId>redis.clients</groupId>
           <artifactId>jedis</artifactId>
           <version>2.9.0</version>
       </dependency>
```

![image-20221212163250771](typora图片/image-20221212163250771.png)

```java
public class D {
    public static void main(String[] args) {
      //1.连接数据库
        Jedis jedis = new Jedis("127.0.0.1", 6379);
        //操作数据库
        jedis.select(4);
      jedis.set("name","heima");
        String name = jedis.get("name");
        System.out.println(name);
        ///关闭数据库
        jedis.close();
    }
}
```

## 3.常规操作

```java
  @Test
    public void test01(){
        Jedis jedis = new Jedis("127.0.0.1", 6379);
        jedis.lpush("list1","a","b","c");
        List<String> list1 = jedis.lrange("list1", 0, -1);
        //System.out.println(list1.toString());
        for (String s:list1) {
            System.out.println(s);
        }
        System.out.println(jedis.llen("list1"));
        jedis.close();
    }
```

**其他都是一样的操作和redis的操作是一模一样的**

![image-20221212164038777](typora图片/image-20221212164038777.png)

![image-20221212164126348](typora图片/image-20221212164126348.png)

![image-20221212171641691](typora图片/image-20221212171641691.png)

![image-20221212171652480](typora图片/image-20221212171652480.png)

![image-20221212171707915](typora图片/image-20221212171707915.png)

![image-20221212171721746](typora图片/image-20221212171721746.png)

```java
package Redis;
import redis.clients.jedis.Jedis;
import redis.clients.jedis.exceptions.JedisBusyException;
import redis.clients.jedis.exceptions.JedisDataException;
/**
 * @author: 杨润
 * @date: 2022/12/12 16:41
 * @description:
 */
public class Service {

    private  String id ;
    private int num;
    public Service(String id,int num){
        this.id = id;
        this.num = num;
    }
    //控制单元
    public void service(){
        Jedis jedis = new Jedis("127.0.0.1", 6379);
        String s = jedis.get("compld:" + id);
        try {
        if (s == null){//不存在
            jedis.setex("compld:" + id,20,Long.MAX_VALUE-num+"");
        }else {//存在

            Long val = jedis.incr("compld:" + id);
            bussiness(id,num-(Long.MAX_VALUE-val));
        }
         }catch (JedisDataException e){
             System.out.println(id+"使用次数已经到达上线，请升级会员");
             return;
         }finally {
             jedis.close();
         }

    }
    //业务操作
    public void bussiness(String  id,Long val ){
        System.out.println(id+"业务操作"+val+"次");
    }
}

class MyThread extends Thread{
   Service service;
   private Object obj = new Object();
   public MyThread(String id,int num){
       service = new Service(id,num);
   }
    @Override
    public void run() {
        while (true){
            synchronized (obj){
                service.service();
                try {
                    Thread.sleep(1000);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
            }
        }
    }
}
class Main{
    public static void main(String[] args) {
        MyThread myThread = new MyThread("初级用户",10);
        MyThread myThread1 = new MyThread("高级用户",30);
        myThread.start();
        myThread1.start();
    }
}
```

## 4.jedis工具类制作

![image-20221212171914532](typora图片/image-20221212171914532.png)

![image-20221212172041082](typora图片/image-20221212172041082.png)

```java
public class JedisUtils {
    public static Jedis getJedis(){
        JedisPoolConfig jpc = new JedisPoolConfig();
        jpc.setMaxTotal(30);//设置最大连接数
        jpc.setMaxIdle(10);
        String host = "127.0.0.1";
        int port = 6379;
        JedisPool jp = new JedisPool(jpc, host, port);
        return jp.getResource();
    }
}
```

![image-20221212172533400](typora图片/image-20221212172533400.png)

<img src="typora图片/image-20221212172544004.png" alt="image-20221212172544004" style="zoom:50%;" />

![image-20221212172600582](typora图片/image-20221212172600582.png)